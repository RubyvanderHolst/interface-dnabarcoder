{% extends 'base_templates/base.html' %}

{% block title %}| Classification{% endblock %}
{% block nav-classify %}active{% endblock %}

{% block container %}
    <head>
        {% load static %}
        <link href="{% static 'css/classification.css' %}" rel="stylesheet">
        <script src="{% static 'js/classification.js' %}"></script>
    </head>

{#    Tabs #}
    {% block container_classification %}
    {% include 'base_templates/base_tabs.html' %}

{#    Container #}
    <div class="container">
        <form action="/classification/results" method="post" target="_blank">
            {% csrf_token %}
            <div id="div_home">
                <h2 class="bg-light border text-center">Classification</h2>
                <div class="row">
                <div class="col">
                    <div class="card h-100">
                        <h5 class="card-header">Sequence input</h5>
                        <div class="card-body">
                            <label for="input_sequences" class="form-label">Select a FASTA-file:</label>
                            <input type="file" class="form-control" id="input_sequences" name="input_sequences" accept=".fasta,.fna,.ffn,.faa,.frn,.fa" required>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card h-100">
                        <h5 class="card-header">Reference input</h5>
                        {#        reference dataset#}
                        <div class="card-body">
                            <label>Choose a reference file:</label><br>
                            <select class="form-select" id="reference_options" name="reference_options"
                                    onchange="show_ref_file_input(this)">
                                <option value="" selected>Use own file</option>
                                {% for file in list_files %}
                                    <option value="{{ file }}" id="{{ file }}" name="{{ file }}">{{ file }}</option>
                                {% endfor %}
                            </select>

                            <br>
                            <div id="div_file_input_reference">
                                <label for="input_reference" class="form-label">Select a reference file (FASTA):</label>
                                <input type="file" class="form-control" id="input_reference" name="input_reference" accept=".fasta,.fna,.ffn,.faa,.frn,.fa" required>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col">
                    {#        radiobox cutoff#}
                    <div class="card h-100">
                        <h5 class="card-header">Similarity cut-off</h5>
                        <div class="card-body">
                            <label class="form-label">Type of similarity cut-off:</label><br>
                            <input type="radio" id="global_cutoff" value="global_cutoff" name="type_cutoff" onclick="cutoff_input_change()" checked>
                            <label for="global_cutoff">Global cut-off</label><br>
                            <input type="radio" id="local_cutoffs" value="local_cutoffs" name="type_cutoff" onclick="cutoff_input_change()">
                            <label for="local_cutoffs">Local cut-offs</label><br><br>
                    {#        global --> input number#}
                            <div id="div_num_cutoff">
                                <label for="num_cutoff">Cut-off value:</label>
                                <input type="number" id="num_cutoff" name="num_cutoff" min="0" max="1" step="0.0001" class="form-control" required>
                            </div>
                    {#        local --> file input#}
                            <input type="file" class="form-control" id="file_cutoff" name="file_cutoff" accept=".json" style="display:none;">
                        </div>
                    </div>
                </div>
            </div>
                <div class="d-grid gap-3 col-2 mx-auto">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </div>


            <div id="div_settings" style="display:none">
                {#    minimum sequence alignment length #}
                <h2 class="bg-light border text-center">Settings</h2>
                <div class="row align-items-end">
                    <div class="col">
                        {#    minproba #}
                        <label for="min_probability" class="form-label">Minimum probability of similarity cutoff</label>
                        <input type="number" min="0" max="1" step="0.0001" id="min_probability" name="min_probability" class="form-control">
                    </div>
                    <div class="col">
                        <label for="min_alignment_length" class="form-label">Minimum sequence alignment length</label>
                        <input type="number" min="0" id="min_alignment_length" name="min_alignment_length" class="form-control" value="400">
                    </div>
                </div>
                <div class="row align-items-end">
                    <div class="col">
                    {#    confidence #}
                        <label for="confidence" class="form-label">Confidence of the similarity cutoff</label>
                        <input type="number" min="0" max="1" step="0.0001" id="confidence" name="confidence" class="form-control">
                    </div>
                    <div class="col">
                        {#    minimum group number #}
                        <label for="min_group_number" class="form-label">Minimum number of groups for prediction</label>
                        <input type="number" min="0" id="min_group_number" name="min_group_number" class="form-control" value="5">
                    </div>
                </div>
                <div class="row align-items-end">
                    <div class="col">
                        {#    minimum sequence number #}
                        <label for="min_seq_number" class="form-label">Minimum number of sequences for prediction</label>
                        <input type="number" min="0" id="min_seq_number" name="min_seq_number" class="form-control" value="50">
                    </div>
                    <div class="col">
                        {#    rank to classify #}
                        <label for="rank" class="form-label">Rank</label>
                            <select id="rank" name="rank" class="form-select">
                                <option value=""></option>
                                <option value="kingdom">Kingdom</option>
                                <option value="phylum">Phylum</option>
                                <option value="class">Class</option>
                                <option value="order">Order</option>
                                <option value="family">Family</option>
                                <option value="species">Species</option>
                            </select>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        {#    maxseqno #}
                        <label for="max_number_seq" class="form-label">Maximum number of sequences per taxon name for best match determination</label>
                        <input type="number" min="0" id="max_number_seq" name="max_number_seq" class="form-control align-bottom">
                    </div>
                    <div class="col"></div>
                </div>
            </div>

        </form>

    </div>
    {% endblock %}
{% endblock %}
